<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nodewise-predictive SEM train using Machine Learning (ML) — SEMml • SEMdeep</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nodewise-predictive SEM train using Machine Learning (ML) — SEMml"><meta property="og:description" content="The function converts a graph to a collection of 
nodewise-based models: each mediator or sink variable can be expressed as 
a function of its parents. Based on the assumed type of relationship, 
i.e. linear or non-linear, SEMml() fits a ML model to each
node (variable) with non-zero incoming connectivity. 
The model fitting is repeated equation-by equation (r=1,...,R) 
times, where R is the number of mediators and sink nodes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMdeep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BarbaraTarantino/SEMdeep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nodewise-predictive SEM train using Machine Learning (ML)</h1>
    <small class="dont-index">Source: <a href="https://github.com/BarbaraTarantino/SEMdeep/blob/HEAD/R/SEMml.R" class="external-link"><code>R/SEMml.R</code></a></small>
    <div class="hidden name"><code>SEMml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function converts a graph to a collection of 
nodewise-based models: each mediator or sink variable can be expressed as 
a function of its parents. Based on the assumed type of relationship, 
i.e. linear or non-linear, <code>SEMml()</code> fits a ML model to each
node (variable) with non-zero incoming connectivity. 
The model fitting is repeated equation-by equation (r=1,...,R) 
times, where R is the number of mediators and sink nodes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SEMml</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  train <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algo <span class="op">=</span> <span class="st">"sem"</span>,</span>
<span>  vimp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>graph</dt>
<dd><p>An igraph object.</p></dd>


<dt>data</dt>
<dd><p>A matrix with rows corresponding to subjects, and
columns to graph nodes (variables).</p></dd>


<dt>train</dt>
<dd><p>A numeric vector specifying the row indices corresponding to
the train dataset (default = NULL).</p></dd>


<dt>algo</dt>
<dd><p>ML method used for nodewise-network predictions.
Six algorithms can be specified:</p><ul><li><p><code>algo="sem"</code> (default) for a linear SEM, see <code><a href="https://rdrr.io/pkg/SEMgraph/man/SEMrun.html" class="external-link">SEMrun</a></code>.</p></li>
<li><p><code>algo="gam"</code> for a generalized additive model, see <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>.</p></li>
<li><p><code>algo="rf"</code> for a random forest model, see <code><a href="https://rdrr.io/pkg/ranger/man/ranger.html" class="external-link">ranger</a></code>.</p></li>
<li><p><code>algo="xgb"</code> for a XGBoost model, see <code><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgboost</a></code>.</p></li>
<li><p><code>algo="nn"</code> for a small neural network model (1 hidden layer and 10 nodes), see <code><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></code>.</p></li>
<li><p><code>algo="dnn"</code> for a large neural network model (1 hidden layers and 1000 nodes), see <code><a href="https://citoverse.github.io/cito/reference/dnn.html" class="external-link">dnn</a></code>.</p></li>
</ul></dd>


<dt>vimp</dt>
<dd><p>A Logical value(default=FALSE). If TRUE compute the variable
importance, considering: (i) the squared value of the t-statistic or F-statistic
of the model parameters for "sem" or "gam"; (ii) the variable importance from
the <code><a href="https://rdrr.io/pkg/ranger/man/importance.ranger.html" class="external-link">importance</a></code> or <code><a href="https://rdrr.io/pkg/xgboost/man/xgb.importance.html" class="external-link">xgb.importance</a></code>
functions for "rf" or "xgb"; (iii) the Olden's connection weights for "nn" or
"dnn".</p></dd>


<dt>thr</dt>
<dd><p>A numerical value indicating the threshold to apply on the variable
importance to color the graph. If thr=NULL (default), the threshold is set to
thr = abs(mean(vimp)).</p></dd>


<dt>verbose</dt>
<dd><p>A logical value. If FALSE (default), the processed graph
will not be plotted to screen.</p></dd>


<dt>...</dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An S3 object of class "ML" is returned. It is a list of 5 objects:</p><ol><li><p>"fit", a list of ML model objects, including: the estimated covariance 
matrix (Sigma),  the estimated model errors (Psi), the fitting indices (fitIdx),
and the signed Shapley R2 values (parameterEstimates), if shap = TRUE,</p></li>
<li><p>"Yhat", a matrix of predictions of sink and mediator graph nodes.</p></li>
<li><p>"model", a list of all the fitted nodewise-based models 
(sem, gam, rf, xgb or nn).</p></li>
<li><p>"graph", the induced DAG of the input graph  mapped on data variables. 
If vimp = TRUE, the DAG is colored based on the variable importance measure,
i.e., if abs(vimp) &gt; thr will be highlighted in red (vimp &gt; 0) or blue
(vimp &lt; 0).</p></li>
<li><p>"data", input training data subset mapping graph nodes.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>By mapping data onto the input graph, <code>SEMml()</code> creates
a set of nodewise-based models based on the directed links, i.e., 
a set of edges pointing in the same direction, between two nodes 
in the input graph that are causally relevant to each other. 
The mediator or sink variables can be characterized in detail as 
functions of their parents. An ML model (sem, gam, rf, xgb, nn, dnn) 
can then be fitted to each variable with non-zero inbound connectivity, 
taking into account the kind of relationship (linear or non-linear). 
With R representing the number of mediators and sink nodes in the 
network, the model fitting process is performed equation-by-equation 
(r=1,...,R) times.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Grassi M, Palluzzi F, Tarantino B (2022). SEMgraph: An R Package for Causal 
Network Analysis of High-Throughput Data with Structural Equation Models. 
Bioinformatics, 38 (20), 4829–4830 &lt;https://doi.org/10.1093/bioinformatics/btac567&gt;</p>
<p>Hastie, T. and Tibshirani, R. (1990) Generalized Additive Models. London: 
Chapman and Hall.</p>
<p>Breiman, L. (2001), Random Forests, Machine Learning 45(1), 5-32.</p>
<p>Chen, T., &amp; Guestrin, C. (2016). XGBoost: A Scalable Tree Boosting System. 
Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge 
Discovery and Data Mining.</p>
<p>Ripley, B. D. (1996) Pattern Recognition and Neural Networks. Cambridge.</p>
<p>Redell, N. (2019). Shapley Decomposition of R-Squared in Machine Learning 
Models. arXiv: Methodology.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load Amyotrophic Lateral Sclerosis (ALS)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span>; <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 160 318</span>
<span class="r-in"><span><span class="va">data</span><span class="op">&lt;-</span> <span class="fu">transformData</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span><span class="va">group</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">group</span>; <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span> <span class="op">(</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0   1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21 139 </span>
<span class="r-in"><span><span class="va">ig</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>; <span class="fu">gplot</span><span class="op">(</span><span class="va">ig</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#...with train-test (0.5-0.5) samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">start</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... rf</span></span></span>
<span class="r-in"><span><span class="co">#res1&lt;- SEMml(ig, data, train, algo="rf", vimp=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"rf"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RF solver ended normally after 23 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: -33.2711  srmr: 0.0860057 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... xgb</span></span></span>
<span class="r-in"><span><span class="co">#res2&lt;- SEMml(ig, data, train, algo="xgb", vimp=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"xgb"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>the standard deviation is zero</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  XGB solver ended normally after 23 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: 9.987585  srmr: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... nn</span></span></span>
<span class="r-in"><span><span class="co">#res3&lt;- SEMml(ig, data, train, algo="nn", vimp=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">res3</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"nn"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NN solver ended normally after 23 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: -37.48277  srmr: 0.1989647 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... gam</span></span></span>
<span class="r-in"><span><span class="co">#res4&lt;- SEMml(ig, data, train, algo="gam", vimp=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">res4</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"gam"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  GAM solver ended normally after 23 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: -46.77283  srmr: 0.3819281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">end</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">end</span><span class="op">-</span><span class="va">start</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time difference of 2.596414 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... sem</span></span></span>
<span class="r-in"><span><span class="co">#res5&lt;- SEMml(ig, data, train, algo="sem", vimp=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">res5</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"sem"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SEM solver ended normally after 23 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: -47.90891  srmr: 0.3040025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#str(res5, max.level=2)</span></span></span>
<span class="r-in"><span><span class="va">res5</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        logL        amse        rmse   srmr.srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -47.9089078   0.8166851   0.9037063   0.3040025 </span>
<span class="r-in"><span><span class="va">res5</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">parameterEstimates</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lhs op   rhs varImp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      10452  ~  6647  0.164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z5606   1432  ~  5606  9.823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z5608   1432  ~  5608 29.897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z7132   1616  ~  7132  2.654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z7133   1616  ~  7133  0.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      4217  ~  1616  2.781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z1432   4741  ~  1432  7.768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z5600   4741  ~  5600  0.554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z5603   4741  ~  5603  0.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z6300   4741  ~  6300  0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z5630   4741  ~  5630  3.339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z14321  4744  ~  1432  5.927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56001  4744  ~  5600  0.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56031  4744  ~  5603  0.351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z63001  4744  ~  6300  0.347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56301  4744  ~  5630  4.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z6647   4747  ~  6647 25.892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z14322  4747  ~  1432  8.210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56002  4747  ~  5600  0.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56032  4747  ~  5603  4.131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z63002  4747  ~  6300  0.973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56302  4747  ~  5630  1.506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z581   54205  ~   581 22.353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z572   54205  ~   572  0.029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z596   54205  ~   596  0.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z598   54205  ~   598  2.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      5530  ~  6647  9.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      5532  ~  6647 17.839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      5533  ~  6647  6.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5534  ~  6647  9.491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      5535  ~  6647 16.447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56061  5600  ~  5606  2.159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56081  5600  ~  5608  5.425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56062  5603  ~  5606  4.948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56082  5603  ~  5608  0.037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      5606  ~  4217  0.669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      5608  ~  4217 34.179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19       596  ~  6647  0.416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56063  6300  ~  5606  1.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z56083  6300  ~  5608 14.431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    79139  ~  6647 19.233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111      836  ~   842 22.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    84134  ~  6647  7.515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z54205   842  ~ 54205 41.336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z317     842  ~   317  6.901</span>
<span class="r-in"><span><span class="fu">gplot</span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of AMSE (in train data)</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va">res1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;<span class="va">rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2335386 </span>
<span class="r-in"><span><span class="va">xgb</span><span class="op">&lt;-</span> <span class="va">res2</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;<span class="va">xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.719355 </span>
<span class="r-in"><span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="va">res3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;<span class="va">nn</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4965907 </span>
<span class="r-in"><span><span class="va">gam</span><span class="op">&lt;-</span> <span class="va">res4</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;<span class="va">gam</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7525285 </span>
<span class="r-in"><span><span class="va">sem</span><span class="op">&lt;-</span> <span class="va">res5</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;<span class="va">sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8166851 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of SRMR (in train data)</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va">res1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>;<span class="va">rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08600574 </span>
<span class="r-in"><span><span class="va">xgb</span><span class="op">&lt;-</span> <span class="va">res2</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>;<span class="va">xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NA </span>
<span class="r-in"><span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="va">res3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>;<span class="va">nn</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1989647 </span>
<span class="r-in"><span><span class="va">gam</span><span class="op">&lt;-</span> <span class="va">res4</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>;<span class="va">gam</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3819281 </span>
<span class="r-in"><span><span class="va">sem</span><span class="op">&lt;-</span> <span class="va">res5</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>;<span class="va">sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> srmr.srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3040025 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of VIMP (in train data)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     28     17 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     26     19 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#nn</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gray50       red2 royalblue3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         31          5          9 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#gam</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     31     14 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     31     14 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of AMSE (in test data)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res1</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.110585 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.355195 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res3</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#nn</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.644702 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res4</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#gam</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.912187 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res5</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8973153 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#...with a binary outcome (1=case, 0=control)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ig1</span><span class="op">&lt;-</span> <span class="fu"><a href="mapGraph.html">mapGraph</a></span><span class="op">(</span><span class="va">ig</span>, type<span class="op">=</span><span class="st">"outcome"</span><span class="op">)</span>; <span class="fu">gplot</span><span class="op">(</span><span class="va">ig1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">outcome</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -1   1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21 139 </span>
<span class="r-in"><span><span class="va">data1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">data</span><span class="op">)</span>; <span class="va">data1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      outcome        207         208      10000       284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALS2       1 -1.8273895 -0.45307006 -0.1360061 0.4530701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALS3       1 -2.5616910 -0.96201413  0.3160400 0.6762093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALS4       1 -0.8003346  0.82216031 -1.1521227 0.5613048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALS5       1 -2.1342965 -0.98709115  1.1521227 0.5064807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALS6       1 -2.0111279  0.02393297  0.5987578 0.1360061</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res6</span> <span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig1</span>, <span class="va">data1</span>, <span class="va">train</span>, algo<span class="op">=</span><span class="st">"nn"</span>, vimp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 : z10452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 : z1432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 : z1616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 : z4217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 : z4741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 : z4744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 : z4747 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 : z54205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 : z5530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 : z5532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 : z5533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 : z5534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 : z5535 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 : z5600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 : z5603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 : z5606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 : z5608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 : z596 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 : z6300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 : z79139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 : z836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 : z84134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 : z842 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 : zoutcome </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NN solver ended normally after 24 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  logL: -35.02422  srmr: 0.1947534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">gplot</span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gray50       red2 royalblue3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         43          9          5 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mse6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res6</span>, <span class="va">data1</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yobs</span> <span class="op">&lt;-</span> <span class="va">group</span><span class="op">[</span><span class="op">-</span><span class="va">train</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="va">mse6</span><span class="op">$</span><span class="va">Yhat</span><span class="op">[</span> ,<span class="st">"outcome"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="performance.html">performance</a></span><span class="op">(</span><span class="va">yobs</span>, <span class="va">yhat</span>, thr<span class="op">=</span><span class="fl">0</span>, F1<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ypred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yobs  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0  4  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 19 55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pre       rec        f1       mcc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.9649123 0.7432432 0.8396947 0.2385495</span>
<span class="r-in"><span><span class="fu"><a href="performance.html">performance</a></span><span class="op">(</span><span class="va">yobs</span>, <span class="va">yhat</span>, thr<span class="op">=</span><span class="fl">0</span>, F1<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ypred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yobs  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0  4  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 19 55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sp        se    acc       mcc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6666667 0.7432432 0.7375 0.2385495</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


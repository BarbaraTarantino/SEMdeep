<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nodewise SEM train using Machine Learning (ML) — SEMml • SEMdeep</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nodewise SEM train using Machine Learning (ML) — SEMml"><meta property="og:description" content="The function converts a graph to a collection of
nodewise-based models: each mediator or sink variable can be expressed as
a function of its parents. Based on the assumed type of relationship,
i.e. linear or non-linear, SEMml() fits a ML model to each
node (variable) with non-zero incoming connectivity.
The model fitting is performed equation-by equation (r=1,...,R)
times, where R is the number of mediators and sink nodes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMdeep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BarbaraTarantino/SEMdeep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nodewise SEM train using Machine Learning (ML)</h1>
    <small class="dont-index">Source: <a href="https://github.com/BarbaraTarantino/SEMdeep/blob/HEAD/R/SEMml.R" class="external-link"><code>R/SEMml.R</code></a></small>
    <div class="hidden name"><code>SEMml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function converts a graph to a collection of
nodewise-based models: each mediator or sink variable can be expressed as
a function of its parents. Based on the assumed type of relationship,
i.e. linear or non-linear, <code>SEMml()</code> fits a ML model to each
node (variable) with non-zero incoming connectivity.
The model fitting is performed equation-by equation (r=1,...,R)
times, where R is the number of mediators and sink nodes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SEMml</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algo <span class="op">=</span> <span class="st">"sem"</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An igraph object.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix with rows corresponding to subjects, and columns
to graph nodes (variables).</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A character vector (as.fctor) of labels for a categorical
output (target). If NULL (default), the categorical output (target) will
not be considered.</p></dd>


<dt id="arg-algo">algo<a class="anchor" aria-label="anchor" href="#arg-algo"></a></dt>
<dd><p>ML method used for nodewise-based predictions.
Four algorithms can be specified:</p><ul><li><p><code>algo="sem"</code> (default) for a linear SEM, see <code><a href="https://rdrr.io/pkg/SEMgraph/man/SEMrun.html" class="external-link">SEMrun</a></code>.</p></li>
<li><p><code>algo="tree"</code> for a CART model, see <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></code>.</p></li>
<li><p><code>algo="rf"</code> for a random forest model, see <code><a href="http://imbs-hl.github.io/ranger/reference/ranger.html" class="external-link">ranger</a></code>.</p></li>
<li><p><code>algo="xgb"</code> for a XGBoost model, see <code><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgboost</a></code>.</p></li>
</ul></dd>


<dt id="arg-thr">thr<a class="anchor" aria-label="anchor" href="#arg-thr"></a></dt>
<dd><p>A numeric value [0-1] indicating the threshold to apply to the
variable importance values to color the graph. If thr = NULL (default), the
threshold is set to thr = 0.5*max(abs(variable importance values)).</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>number of bootstrap samples that will be used to compute cheap
(lower, upper) CIs for all input variable weights. As a default, nboot = 0.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>number of cpu cores (default = 2)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value. If FALSE (default), the processed graph
will not be plotted to screen.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An S3 object of class "ML" is returned. It is a list of 5 objects:</p><ol><li><p>"fit", a list of ML model objects, including: the estimated covariance
matrix (Sigma), the estimated model errors (Psi), the fitting indices (fitIdx),
and the parameterEstimates, i.e., the variable importance measures (VarImp).</p></li>
<li><p>"gest", the data.frame of variable importances (parameterEstimates)
of outcome levels, if outcome != NULL.</p></li>
<li><p>"model", a list of all the fitted non-linear nodewise-based models
(tree, rf, xgb, nn or dnn).</p></li>
<li><p>"graph", the induced DAG of the input graph  mapped on data variables.
The DAG with colored edge/nodes based on the variable importance measures,
i.e., if abs(VarImp) &gt; thr will be highlighted in red (VarImp &gt; 0) or blue
(VarImp &lt; 0). If the outcome vector is given, nodes with variable importances
summed over the outcome levels, i.e. sum(VarImp[outcome levels])) &gt; thr,
will be highlighted in pink.</p></li>
<li><p>"data", input data subset mapping graph nodes.</p></li>
</ol><p>Using the default <code>algo="sem"</code>, the usual output of a linear nodewise-based
SEM, see <code><a href="https://rdrr.io/pkg/SEMgraph/man/SEMrun.html" class="external-link">SEMrun</a></code> (algo="cggm"), will be returned.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>By mapping data onto the input graph, <code>SEMml()</code> creates
a set of nodewise models based on the directed links, i.e.,
a set of edges pointing in the same direction, between two nodes
in the input graph that are causally relevant to each other.
The mediator or sink variables are defined as functions of their parents.
Then, an ML model (sem, tree, rf, xgb) can be fitted to each variable with
non-zero inbound connectivity. The model fitting process is performed
equation-by-equation (r=1,...,R) times, where R represents the number of
mediators and sink nodes in the input graph.</p>
<p>If boot != 0, the function will implement the cheap bootstrapping proposed by
Lam (2002) to generate uncertainties (i.e., bootstrap <code>90%CIs</code>) for ML
parameters. Bootstrapping can be enabled by setting a small number (1 to 10) of
bootstrap samples. Note, however, that the computation can be time-consuming for
massive MLs, even with cheap bootstrapping!</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Grassi M., Palluzzi F., and Tarantino B. (2022). SEMgraph: An R Package for Causal
Network Analysis of High-Throughput Data with Structural Equation Models.
Bioinformatics, 38 (20), 4829–4830 &lt;https://doi.org/10.1093/bioinformatics/btac567&gt;</p>
<p>Breiman L., Friedman J.H., Olshen R.A., and Stone, C.J. (1984) Classification
and Regression Trees. Chapman and Hall/CRC.</p>
<p>Breiman L. (2001). Random Forests, Machine Learning 45(1), 5-32.</p>
<p>Chen T., and Guestrin C. (2016). XGBoost: A Scalable Tree Boosting System.
Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge
Discovery and Data Mining.</p>
<p>Lam, H. (2022). Cheap bootstrap for input uncertainty quantification. WSC '22:
Proceedings of the Winter Simulation Conference, 2318-2329.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load Amyotrophic Lateral Sclerosis (ALS)</span></span></span>
<span class="r-in"><span><span class="va">ig</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">&lt;-</span> <span class="fu">transformData</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span><span class="va">group</span><span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#...with train-test (0.5-0.5) samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">start</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... tree</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span>, algo<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SEM model via ML...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TREE solver ended normally after 23 iterations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  logL:-45.080145  srmr:0.201877</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... rf</span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span>, algo<span class="op">=</span><span class="st">"rf"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SEM model via ML...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> RF solver ended normally after 23 iterations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  logL:-33.16687  srmr:0.086188</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... xgb</span></span></span>
<span class="r-in"><span><span class="va">res3</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span>, algo<span class="op">=</span><span class="st">"xgb"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SEM model via ML...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> XGB solver ended normally after 23 iterations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  logL:70.10035  srmr:0.001439</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... sem</span></span></span>
<span class="r-in"><span><span class="va">res4</span><span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span>, algo<span class="op">=</span><span class="st">"sem"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SEM model via ML...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> SEM solver ended normally after 23 iterations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  logL:-48.441286  srmr:0.306438</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">end</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">end</span><span class="op">-</span><span class="va">start</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time difference of 1.4805 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#visualizaation of the colored dag for algo="sem"</span></span></span>
<span class="r-in"><span><span class="fu">gplot</span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">graph</span>, l<span class="op">=</span><span class="st">"dot"</span>, main<span class="op">=</span><span class="st">"sem"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of fitting indices (in train data)</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span> <span class="co">#tree</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        logL        amse        rmse        srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -45.0801450   0.6403463   0.8002164   0.2018772 </span>
<span class="r-in"><span><span class="va">res2</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         logL         amse         rmse         srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -33.16686964   0.23129978   0.48093636   0.08618768 </span>
<span class="r-in"><span><span class="va">res3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         logL         amse         rmse         srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.010035e+01 1.865892e-04 1.365977e-02 1.439282e-03 </span>
<span class="r-in"><span><span class="va">res4</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">fitIdx</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        logL        amse        rmse        srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -48.4412858   0.8574470   0.9259843   0.3064378 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of parameter estimates (in train data)</span></span></span>
<span class="r-in"><span><span class="fu">parameterEstimates</span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co">#tree</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lhs op   rhs VarImp lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10452  ~  6647 16.112     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 84134  ~  6647 24.516     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   596  ~  6647 10.728     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  4747  ~  6647 19.529     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 79139  ~  6647 25.164     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  5530  ~  6647 27.370     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  5532  ~  6647 32.388     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  5533  ~  6647 20.453     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  5534  ~  6647 30.462     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  5535  ~  6647 25.923     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   842  ~ 54205 32.106     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 54205  ~   581 35.206     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54205  ~   572  6.647     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 54205  ~   596  6.135     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 54205  ~   598 15.418     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   842  ~   317  6.470     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   836  ~   842 28.768     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1616  ~  7132 14.271     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1616  ~  7133 19.620     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4217  ~  1616 12.718     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  5606  ~  4217 11.445     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  5608  ~  4217 35.143     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1432  ~  5606 15.674     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  5600  ~  5606 12.193     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  5603  ~  5606 14.378     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  6300  ~  5606 11.595     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1432  ~  5608 22.355     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  5600  ~  5608 19.935     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  5603  ~  5608 13.768     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  6300  ~  5608 25.313     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  4747  ~  1432 22.556     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   4741  ~  1432 24.848     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  4744  ~  1432 19.416     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  4747  ~  5600 11.291     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4741  ~  5600  7.237     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  4744  ~  5600 16.367     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  4747  ~  5603 13.228     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   4741  ~  5603 13.976     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  4744  ~  5603 17.849     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  4747  ~  6300  3.397     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  4741  ~  6300  2.549     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  4744  ~  6300 10.920     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  4747  ~  5630  8.191     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  4741  ~  5630  9.045     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  4744  ~  5630 10.093     0     0</span>
<span class="r-in"><span><span class="fu">parameterEstimates</span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lhs op   rhs VarImp lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10452  ~  6647  0.097     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 84134  ~  6647  0.445     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   596  ~  6647  0.117     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  4747  ~  6647  0.254     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 79139  ~  6647  0.665     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  5530  ~  6647  0.338     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  5532  ~  6647  0.480     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  5533  ~  6647  0.317     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  5534  ~  6647  0.502     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  5535  ~  6647  0.383     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   842  ~ 54205  0.420     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 54205  ~   581  0.569     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54205  ~   572  0.053     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 54205  ~   596 -0.009     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 54205  ~   598  0.214     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   842  ~   317  0.133     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   836  ~   842  0.479     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1616  ~  7132  0.060     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1616  ~  7133  0.055     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4217  ~  1616  0.026     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  5606  ~  4217 -0.143     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  5608  ~  4217  0.697     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1432  ~  5606  0.132     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  5600  ~  5606 -0.037     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  5603  ~  5606  0.181     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  6300  ~  5606  0.014     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1432  ~  5608  0.456     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  5600  ~  5608  0.110     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  5603  ~  5608  0.043     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  6300  ~  5608  0.225     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  4747  ~  1432  0.086     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   4741  ~  1432  0.250     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  4744  ~  1432  0.180     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  4747  ~  5600  0.098     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4741  ~  5600  0.093     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  4744  ~  5600  0.167     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  4747  ~  5603  0.105     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   4741  ~  5603  0.109     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  4744  ~  5603  0.085     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  4747  ~  6300  0.025     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  4741  ~  6300 -0.025     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  4744  ~  6300  0.025     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  4747  ~  5630  0.033     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  4741  ~  5630  0.050     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  4744  ~  5630  0.054     0     0</span>
<span class="r-in"><span><span class="fu">parameterEstimates</span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lhs op   rhs VarImp lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10452  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 84134  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   596  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  4747  ~  6647  0.263     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 79139  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  5530  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  5532  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  5533  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  5534  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  5535  ~  6647  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   842  ~ 54205  0.694     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 54205  ~   581  0.632     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54205  ~   572  0.104     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 54205  ~   596  0.048     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 54205  ~   598  0.216     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   842  ~   317  0.306     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   836  ~   842  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1616  ~  7132  0.430     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1616  ~  7133  0.570     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4217  ~  1616  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  5606  ~  4217  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  5608  ~  4217  1.000     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1432  ~  5606  0.527     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  5600  ~  5606  0.409     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  5603  ~  5606  0.521     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  6300  ~  5606  0.381     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1432  ~  5608  0.473     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  5600  ~  5608  0.591     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  5603  ~  5608  0.479     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  6300  ~  5608  0.619     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  4747  ~  1432  0.300     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   4741  ~  1432  0.397     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  4744  ~  1432  0.266     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  4747  ~  5600  0.092     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   4741  ~  5600  0.142     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  4744  ~  5600  0.349     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  4747  ~  5603  0.194     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   4741  ~  5603  0.264     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  4744  ~  5603  0.202     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  4747  ~  6300  0.036     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  4741  ~  6300  0.028     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  4744  ~  6300  0.047     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  4747  ~  5630  0.115     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  4741  ~  5630  0.168     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  4744  ~  5630  0.136     0     0</span>
<span class="r-in"><span><span class="fu">parameterEstimates</span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lhs op   rhs VarImp lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10452  ~  6647  0.411     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  84134  ~  6647  2.776     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    596  ~  6647 -0.653     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  4747  ~  6647  5.331     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 79139  ~  6647  4.441     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  5530  ~  6647  3.094     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  5532  ~  6647  4.277     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  5533  ~  6647 -2.575     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  5534  ~  6647  3.120     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  5535  ~  6647 -4.107     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    842  ~ 54205 -6.545     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  54205  ~   581 -4.883     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  54205  ~   572  0.161     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  54205  ~   596 -0.284     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  54205  ~   598 -1.702     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   842  ~   317 -2.667     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    836  ~   842 -4.841     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  1616  ~  7132  1.662     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  1616  ~  7133  0.367     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  4217  ~  1616 -1.689     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  5606  ~  4217 -0.828     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  5608  ~  4217  5.921     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  1432  ~  5606  3.182     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  5600  ~  5606  1.493     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  5603  ~  5606  2.255     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  6300  ~  5606  1.168     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  1432  ~  5608  5.564     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  5600  ~  5608 -2.371     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  5603  ~  5608  0.181     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  6300  ~  5608 -3.871     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  4747  ~  1432  2.995     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  4741  ~  1432  2.889     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  4744  ~  1432  2.522     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  4747  ~  5600  0.252     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  4741  ~  5600 -0.730     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  4744  ~  5600 -0.738     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  4747  ~  5603  2.135     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  4741  ~  5603  0.870     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  4744  ~  5603  0.588     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  4747  ~  6300  1.023     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  4741  ~  6300  0.891     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  4744  ~  6300  0.572     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  4747  ~  5630 -1.275     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  4741  ~  5630 -1.892     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  4744  ~  5630 -2.107     0     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of VarImp (in train data)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#tree</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     25     20 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     35     10 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     25     20 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gray50       red2 royalblue3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         35          5          5 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Comparison of AMSE, R2, SRMR (in test data)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res1</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">)</span> <span class="co">#tree</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       amse         r2       srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.93770362 0.06229638 0.22693793 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">)</span> <span class="co">#rf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       amse         r2       srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92435872 0.07564128 0.17600941 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res3</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">)</span> <span class="co">#xgb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       amse         r2       srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.97398929 0.02601071 0.15433519 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res4</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">PE</span><span class="op">)</span> <span class="co">#sem</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      amse        r2      srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8572186 0.1427814 0.2972509 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#...with a categorical (as.factor) outcome</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"control"</span>, <span class="st">"case"</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    case control </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     139      21 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">SEMml</span><span class="op">(</span><span class="va">ig</span>, <span class="va">data</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span>, <span class="va">outcome</span><span class="op">[</span><span class="va">train</span><span class="op">]</span>, algo<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running SEM model via ML...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TREE solver ended normally after 25 iterations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  logL:-48.72171  srmr:0.196861</span>
<span class="r-in"><span><span class="fu">gplot</span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SEMml-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gray50   red2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     25     20 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  pink white </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2    11 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res5</span>, <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span>, <span class="va">outcome</span><span class="op">[</span><span class="op">-</span><span class="va">train</span><span class="op">]</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       amse         r2       srmr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91133182 0.08866818 0.22538176 </span>
<span class="r-in"><span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="va">pred</span><span class="op">$</span><span class="va">Yhat</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yhat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         case    control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.4773726 -0.4773726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.4773726 -0.4773726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.4773726 -0.4773726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.4773726 -0.4773726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.4773726 -0.4773726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -0.6137648  0.6137648</span>
<span class="r-in"><span><span class="va">yobs</span> <span class="op">&lt;-</span> <span class="va">outcome</span><span class="op">[</span><span class="op">-</span><span class="va">train</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yobs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] case case case case case case</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: case control</span>
<span class="r-in"><span><span class="fu"><a href="classificationReport.html">classificationReport</a></span><span class="op">(</span><span class="va">yobs</span>, <span class="va">yhat</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yobs      case control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   case      57      17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   control    2       4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="SEMml-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              precision    recall        f1 accuracy      mcc support</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> case         0.9661017 0.7702703 0.8571429   0.7625 0.261562      74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control      0.1904762 0.6666667 0.2962963   0.7625 0.261562       6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> macro avg    0.5782889 0.7184685 0.5767196   0.7625 0.261562      80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weighted avg 0.9079298 0.7625000 0.8150794   0.7625 0.261562      80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              support_prop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> case                0.925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> control             0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> macro avg           1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weighted avg        1.000</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

